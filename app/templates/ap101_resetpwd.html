<!DOCTYPE html>
<html lang="en">

    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Bootstrap 5 Login Form Example</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
            integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">
      <div class="container">
    <header class="d-flex justify-content-center py-3">
      <img height="50" src="{{ url_for('static', filename='SPSPL_Logo.png') }}" />
    </header>
  </div>

  <div class="b-example-divider"></div>
<script src="{{ url_for('static', filename='login.js') }}"></script>

    </head>

    <body>
<form action="{{ url_for("resetpwd")}}" method="post">
        <div class="container-fluid vh-100" style="margin-top:10px">
            <div class="" style="margin-top:10px">
                <div class="rounded d-flex justify-content-center">
                    <div class="col-md-4 col-sm-12 shadow-lg p-5 bg-light">
                          <div id="alert1">
                          </div>
                         <div class="text-center">
                            <h3 class="text-primary">Reset Password</h3>
                        </div>
                            <div class="p-4">
                                <div class="input-group mb-3" >
                                    <span class="input-group-text bg-primary"><i
                                            class="bi bi-person-fill text-white"></i></span>
                                    <input  id="username" name="username" type="text" class="form-control" placeholder="Username" value="{{ request.form.get('username','') }}" required>
                                </div>
                                </div>
                                   <div class="dropdown-divider"></div>
                                   <h10>&nbsp </h10>
                                   <div class="input-group mb-3">
                                    <span class="input-group-text bg-primary"><i
                                            class="bi bi-check-square-fill text-white"></i></span>
                                    <input id="ecode" name="ecode" type="Code" class="form-control" placeholder="Email Verification Code" value="{{ request.form.get('ecode','') }}">
                                </div>
                               <div class="row">
                                 <div class="col-md-4">
                                <button class="btn btn-primary text-center mt-2" name="submitt" type="submit" onclick="submit()">
                                    Submit
                                </button> 
                                  </div>
                                 <div class="col-md-4">
                                    &nbsp
                                 </div>
                                  <div class="col-md-4 text-end">
                                <a href="{{ url_for('login') }}">SignIn</a>
                              </div>
                               </div>
                          </div>
                    </div>
                </div>
            </div>
       <script type="text/javascript">
        const element = document.querySelector('#alert1')
        let p_msg ='{{ p_nxt_msg }}';
        let s_msg ='{{ s_nxt_msg }}';
        let e_msg ='{{ e_nxt_msg }}';
        console.log('p_msg:'+p_msg)
        console.log('e_msg:'+e_msg)
        if (p_msg != null && p_msg != '') {
            a = '<div align="center" class="alert alert-primary">'+ p_msg + '</div>'
            element.insertAdjacentHTML('beforeend', a);
         }
        if (e_msg != null &&  e_msg != '') {
            a = '<div class="alert alert-danger">'+ e_msg + '</div>'
            element.insertAdjacentHTML('beforeend', a);
         }
        if (s_msg != null && s_msg != '') {
            a = '<div class="alert alert-success">'+ s_msg + '</div>'
            element.insertAdjacentHTML('beforeend', a);
         }
        if ((e_msg == null ||  e_msg == '') && (document.getElementById("username").value) != '') {
           console.log('case1')
           disable_user();
         }
        console.log((document.getElementById("username").value))
        console.log({{ request.form.get('username','') }})
        if ((e_msg == null ||  e_msg == '') && (document.getElementById("username").value) == '') {
           console.log('case2')
           enable_user();
         }
     if ((e_msg != null ||  e_msg != '') && (document.getElementById("username").value) != '' && (document.getElementById("ecode").value) == '')
        {
        console.log('case3')
        disable_user();
         }
     if ((s_msg != null ||  s_msg != '') && (document.getElementById("username").value) != '' && (document.getElementById("ecode").value) != '')
         {
        console.log('case4')
          document.getElementById("username").readOnly = true;
          document.getElementById("ecode").readOnly = true;
	  document.getElementById("submitt").disabled = true;
         }
        function enable_user()
       {
          document.getElementById("username").readOnly = false;
          document.getElementById("ecode").readOnly = true;
       }
       function disable_user()
       {
          document.getElementById("username").readOnly = true;
          document.getElementById("ecode").readOnly = false;
       }
       function alert_cal(msg)
      {
        alert(msg);
        return false;
      }
        </script>
</form>
</body>
<div class="container">
  <footer class="d-flex flex-wrap justify-content-center align-items-center py-3 my-4 border-top">
      <span    class="mb-3 mb-md-0">&copy; 2022 Senthur Power Company, Inc</span>
</footer>
</div>
</html>
